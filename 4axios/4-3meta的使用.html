<!DOCTYPE html>
<html>
    <head>
        <script src='../vue.js'></script>
        <script src='../node_modules/vue-router/dist/vue-router.js'></script>
    </head>
    <body>
        <div id="ss">
            <router-link to="/home">首页</router-link>
            <router-link to='/blog'>我的博客</router-link>
            <a href='javascript:void(0)'>退出</a>
            <router-view></router-view>
        </div>
        <script>
            var Home={
                template:'<div>我是首页</div>'
            }
            var Blog={
                template:'<div>我是博客</div>'
            }
            var Login={
                data(){
                    return{
                        name:'',
                        pwd:'',
                    }
                },
                template:
                `
                <div>
                <input type="text" v-model='name'/>
                <input type="password" v-model='pwd'/>
                <input type='button' value='登录' @click="userInput">
                </div>
                `,
                methods:{
                    userInput(){
                        localStorage.setItem('user',{name:this.name,pwd:this.pwd})
                        this.$router.push({
                            path:"/blog"
                        })
                    }
                }
            }
            var router=new VueRouter({
                routes:[
                    {
                        path:'/',
                        redirect:'/home',
                    },
                    {
                        path:'/home',
                        component:Home,
                    },
                    {
                        path:'/blog',
                        component:Blog,
                        //用于判断是否需要登录的数据
                        meta:{
                            auth:true,
                        }
                    },
                    {
                        path:'/login',
                        component:Login,
                    }
                ]
            })
            //全局守卫
            router.beforeEach((to,from,next)=>{
                console.log(to)
                console.log(from)
                //如果为true,则跳转到登录页面
                if(to.meta.auth){
                    //若已登录，则跳转到对应页面
                    if(localStorage.getItem('user')){
                        next()
                    }else{
                        next({
                        path:'/login'
                    })
                    }
                }else{
                     next()
                }
               
            })
            new Vue({
                el:'#ss',
                data(){
                    return{
                    }
                },
                router,
            })
        </script>
    </body>
</html>

